---
title: "Modeling Barrel Classification in Big Ten College Baseball"
author: "Kyle Gilbert"
date: "`r Sys.Date()`"
output: 
  pdf_document:
    latex_engine: pdflatex
    number_sections: true
---

```{r dependencies}

#| echo: false
#| message: false
#| warning: false

# Install pacman package
if (!require("pacman")) install.packages("pacman")

# Load all packages, installing if necessary
pacman::p_load(dplyr, mgcv, ggplot2, pROC, rsample, purrr, stats, ranger, utils)
```

```{r load data}

#| echo: false
#| message: false
#| warning: false
#| output: false

# Read in Big 10 batted-ball data
data <- read.csv("data.csv")
```

```{r preprocessing}

#| echo: false
#| warning: false
#| output: false

# Compute exit velocity mean & sd
meanEV <- mean(df$EV, na.rm = TRUE)
sdEV <- sd(df$EV, na.rm = TRUE)

df <- df %>%
  mutate(
    Hit = PlayResult %in% c("Single", "Double", "Triple", "HomeRun"),
    Bases = case_when(
      PlayResult == "Single"  ~ 1,
      PlayResult == "Double"  ~ 2,
      PlayResult == "Triple"  ~ 3,
      PlayResult == "HomeRun" ~ 4,
      TRUE ~ 0
    )
  ) %>% 
  filter(
    EV >= (meanEV - 2 * sdEV), # ~2.5th percentile
    EV <= (meanEV + 2 * sdEV)  # ~97.5th percentile
  )
```
